---
title: "testing_bites_plots"
format: html
editor: visual
---

# newdata for Naso

```{r}
naso_nd <- 
  naso_mod_hurdle |> 
  emmeans(~ Depth_band |
            Species, 
          type = "link") |> 
  gather_emmeans_draws() |> 
  mutate(Exp_bites = exp(.value)) |> 
  dplyr::select(-.chain,
                -.iteration,
                -.value) |> 
  summarise_draws(median, 
                  HDInterval::hdi) |> 
  as.data.frame()
```

# correct values for Naso: 0 for 30m (Nl)

```{r}
naso_nd_nl <- 
naso_nd |> 
  filter(Species == "Naso lituratus") |> 
  rows_delete(tibble(Depth_band = "30m")) |> 
  add_row(Depth_band = "30m",
           Species = "Naso lituratus",
           variable = "Exp_bites", 
           median = 0,
           lower = 0,
           upper = 0) |> 
  mutate(Species = factor(Species),
         Depth_band = factor(Depth_band,
                             levels = c("10m",
                                        "20m",
                                        "30m",
                                        "50m")))
```


# plot Nl

```{r}
p_bites_nl <-
naso_nd_nl |> 
  filter(Species == "Naso lituratus") |> 
  ggplot(aes(x = Depth_band,
             y = median)) +
  geom_pointrange(aes(ymin = lower,
                      ymax = upper),
                  shape = 21,
                  size = 1,
                  fatten = 3,
                  color = "#DDD487",
                  fill = "#DDD487") +
  scale_y_continuous(name = "Number of bites (3h)",
                     limits = c(0, 160),
                     breaks = seq(0, 160, by = 40)) +
  #scale_x_discrete(name = "") +
  theme_classic() +
    ggtitle(expression(italic(Naso~lituratus))) +
     theme(axis.title.x = element_blank(),
           axis.text.x = element_blank(),
           axis.ticks.x = element_blank(),
        axis.title.y = element_text(size = 15),
        axis.text.y = element_text(size = 12),
        plot.title = element_text(size = 18)) +
  geom_image(data = tibble(Depth_band = 4.2,
                           median = 155),
             aes(image = "naso-lituratus-naso-tang.png"),
             size = 0.30)
```

# correct values for Naso: 0 for 20m (Nu)

```{r}
naso_nd_nu <- 
naso_nd |> 
  filter(Species == "Naso unicornis") |> 
  rows_delete(tibble(Depth_band = "20m")) |> 
  add_row(Depth_band = "20m",
           Species = "Naso unicornis",
           variable = "Exp_bites", 
           median = 0,
           lower = 0,
           upper = 0) |> 
  mutate(Species = factor(Species),
         Depth_band = factor(Depth_band,
                             levels = c("10m",
                                        "20m",
                                        "30m",
                                        "50m")))
```

# plot Nu

```{r}
p_bites_nu <- 
naso_nd_nu |> 
  filter(Species == "Naso unicornis") |> 
  ggplot(aes(x = Depth_band,
             y = median)) +
  geom_pointrange(aes(ymin = lower,
                      ymax = upper),
                  shape = 21,
                  size = 1,
                  fatten = 3,
                  color = "#929FBD",
                  fill = "#929FBD") +
  scale_y_continuous(name = "Number of bites (3h)",
                     limits = c(0, 160),
                     breaks = seq(0, 160, by = 40)) +
  #scale_x_discrete(name = "") +
  theme_classic() +
    ggtitle(expression(italic(Naso~unicornis))) +
     theme(
        axis.title = element_text(size = 15),
        axis.text = element_text(size = 12),
        plot.title = element_text(size = 18)) +
  geom_image(data = tibble(Depth_band = 4.2,
                           median = 155),
             aes(image = "naso-unicornis-bluespine-unicornfish.png"),
             size = 0.30)
```

Max values for 10m and 50m are comparable
Maybe this is why their range is more or less the same?
This prob just proves that size is a large factor in the consumption of algae?

# combine plots

```{r}
p_bites <- 
p_bites_all /
  p_bites_nl /
  p_bites_nu + plot_annotation(tag_levels = "a")
```

# ggsave 

```{r}
ggsave("Fig. 5. bites.jpeg",
       plot =p_bites, 
       dpi = 600, 
       height = 9, 
       width = 9, 
       units = "in")
```


# summary: all browsers

```{r}
all_brow_mod_hurdle |>  
  as_draws_df() |> 
  dplyr::select(matches("^b_.*")) |>
  exp() |> 
  summarise_draws(median,
                  HDInterval::hdi,
                  Pl= ~mean(.x < 1),
                  Pg = ~mean(.x > 1))
```

# newdata for all browsers

```{r}
all_brow_nd <- 
  all_brow_mod_hurdle |> 
  emmeans(~ Depth_band, 
          type = "link") |> 
  gather_emmeans_draws() |> 
  mutate(Exp_bites = exp(.value)) |> 
  dplyr::select(-.chain,
                -.iteration,
                -.value) |> 
  summarise_draws(median, 
                  HDInterval::hdi) |> 
  as.data.frame()
```

# plot: all browsers

```{r}
p_bites_all <- 
all_brow_nd |> 
  ggplot(aes(x = Depth_band,
             y = median)) +
  geom_pointrange(aes(ymin = lower,
                      ymax = upper),
                  shape = 21,
                  size = 1,
                  fatten = 3,
                  color = "#8AA17D",
                  fill = "#8AA17D") +
  scale_y_continuous(name = "Number of bites (3h)",
                     limits = c(0, 160),
                     breaks = seq(0, 160, by = 40)) +
  #scale_x_discrete(name = "") +
  theme_classic() +
    ggtitle("Total browsers") +
     theme(axis.title.x = element_blank(),
           axis.text.x = element_blank(),
           axis.ticks.x = element_blank(),
        axis.title.y = element_text(size = 15),
        axis.text.y = element_text(size = 12),
        plot.title = element_text(size = 18)) +
  geom_image(data = tibble(Depth_band = 4.2,
                           median = 155),
             aes(image = "naso.png"),
             size = 0.30) +
  geom_image(data = tibble(Depth_band = 4.2,
                           median = 123),
             aes(image = "siganid.png"),
             size = 0.30)
```

# summary: all browsers

```{r}
naso_mod_hurdle|>  
  as_draws_df() |> 
  dplyr::select(matches("^b_.*")) |>
  exp() |> 
  summarise_draws(median,
                  HDInterval::hdi,
                  Pl= ~mean(.x < 1),
                  Pg = ~mean(.x > 1))
```
