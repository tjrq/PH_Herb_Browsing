---
title: "Length_results_plots"
format: html
editor: visual
---

# Length

# Exceedence prob

```{r}
log_length_mod |> as_draws_df() |> 
  dplyr::select(matches("^b_.*")) |> 
  exp() |> 
  summarise_draws(median,
                  HDInterval::hdi,
                  Pl= ~mean(.x < 1),
                  Pg = ~mean(.x > 1)) |> 
  filter(Pl > 0.85 | 
           Pg > 0.85)
```

# newdata for length

```{r}
log_length_nd <- 
  log_length_mod |> 
  emmeans(~ Depth_band, 
          type = "link") |> 
  gather_emmeans_draws() |> 
  mutate(Exp_length = exp(.value)) |> 
  dplyr::select(-.chain,
                -.iteration,
                -.value) |> 
  summarise_draws(median, 
                  HDInterval::hdi) |> 
  as.data.frame()
```

# plot length in cm

```{r}
p_brow_length <- 
log_length_nd |> 
  ggplot(aes(x = Depth_band,
             y = median)) +
  geom_pointrange(aes(ymin = lower,
                      ymax = upper),
                  shape = 21,
                  size = 1,
                  fatten = 3,
                  color = "#DDD487",
                  fill = "#DDD487") +
  scale_y_continuous(name = "Total length (cm)",
                     limits = c(0, 40),
                     breaks = seq(0, 40, by = 10)) +
  #scale_x_discrete(name = "") +
  theme_classic() +
    #ggtitle("Total herbivores") +
     theme(
        axis.title = element_text(size = 15),
        axis.text = element_text(size = 12),
        plot.title = element_text(size = 18))
```

# combine abun and length plots

```{r}
p_abun_biom <- 
p_brow_abun / p_brow_length
```

## ggsave

```{r}
ggsave("Fig. 3. coral_macroalgae.jpeg",
       plot =p_abun_biom, 
       dpi = 600, 
       height = 8, 
       width = 8, 
       units = "in")
```
